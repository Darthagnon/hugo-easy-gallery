<!--
Put this file in /layouts/shortcodes/gallery.html
Documentation and licence at https://github.com/liwenyip/hugo-easy-gallery/
-->
<!-- count how many times we've called this shortcode; load the css if it's the first time -->
{{- if not ($.Page.Scratch.Get "figurecount") -}}<link rel="stylesheet" href="/css/hugo-easy-gallery.css" />{{- end -}}
{{- $.Page.Scratch.Add "figurecount" 1 -}}
{{- $baseURL := .Site.BaseURL -}}
{{- $thumbnailSize := .Get "thumbnail-size" | default "300x300" -}}
<div class="gallery caption-position-{{ with .Get "caption-position" | default "bottom" }}{{.}}{{end}} caption-effect-{{ with .Get "caption-effect" | default "slide" }}{{.}}{{end}} hover-effect-{{ with .Get "hover-effect" | default "zoom" }}{{.}}{{end}} {{ if ne (.Get "hover-transition") "none" }}hover-transition{{end}}" itemscope itemtype="http://schema.org/ImageGallery">
	<!-- Generate figures for all page resources of type image. -->
	{{- range $.Page.Resources.ByType "image" -}}

		{{- $thumbnail := .Fill $thumbnailSize -}}
		<div class="box">
			<figure itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
				<div class="img" style="background-image: url('{{ $thumbnail.RelPermalink }}');" >
					<img itemprop="thumbnail" src="{{ $thumbnail.RelPermalink }}" width="{{ $thumbnail.Width }}" height="{{ $thumbnail.Height }}" alt="{{ .Title }}" /><!-- <img> hidden if in .gallery -->
				</div>
				{{- with .Title -}}
				<figcaption>
					<p>{{ . }}</p>
				</figcaption>
				{{- end -}}
				<a href="{{ .RelPermalink }}" itemprop="contentUrl"></a><!-- put <a> last so it is stacked on top -->
			</figure>
		</div>
	{{- end }}
</div>
